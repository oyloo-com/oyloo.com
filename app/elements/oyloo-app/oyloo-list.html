<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="oyloo-list">
  <style>
    paper-card {
      width: calc(100% - 8px);
      margin: 4px;
    }
    
    paper-icon-button {
      float: right;
    }
    
    #list {
      width: 100%;
    }
  </style>
  <template>
    <firebase-document location="[[_documentLocation]]" data="{{doc}}"></firebase-document>
    <firebase-collection location="[[_computeLocation(_documentLocation, 'l')]]" data="{{items}}"></firebase-collection>
    <paper-card heading="[[doc.n]]">
      <div class="card-actions">
        <paper-icon-button id="button" icon="hardware:keyboard-arrow-up" title="more info"
        on-tap="_toggle">
        </paper-icon-button>
        <iron-collapse id="list">
          <template is="dom-repeat" items="[[items]]" as="item">
            <oyloo-item item="[[item]]"></oyloo-item>
          </template>
        </iron-collapse>
      </div>
    </paper-card>
  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'oyloo-list',
        properties: {
          base: String,
          path: String,
          _documentLocation: {
            type: String,
            computed: '_computeLocation(base, path)'
          }
        },
        _debug: function(v) {
          console.log(v);
        },
        _toggle: function() {
          this.$.button.icon = this.$.list.opened ?
            'hardware:keyboard-arrow-up' :
            'hardware:keyboard-arrow-down';
          this.$.list.toggle();
        },
        _computeLocation: function(base, path) {
          if (base && path) {
            return base + '/' + path;
          }
        }
      });
    })();
  </script>
</dom-module>

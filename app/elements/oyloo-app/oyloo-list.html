<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-collection.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-document.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="oyloo-document-behavior.html">
<link rel="import" href="oyloo-item.html">

<dom-module id="oyloo-list">
  <style>
    paper-card {
      width: calc(100% - 8px);
      margin: 4px;
    }
    
    paper-icon-button {
      float: right;
    }
    
    #list {
      width: 100%;
    }
  </style>
  <template>
    <firebase-document location="[[_documentLocation]]" data="{{doc}}"></firebase-document>
    <firebase-collection location="[[_computeLocation(_documentLocation, 'l')]]" data="{{items}}"></firebase-collection>
    <paper-card heading="[[doc.n]]">
      <div class="card-actions">
        <paper-icon-button id="button" icon="hardware:keyboard-arrow-down" title="more info"
        on-tap="_toggle">
        </paper-icon-button>
        <iron-collapse id="list" opened>
          <template is="dom-repeat" items="[[items]]" as="item">
            <oyloo-item base="[[base]]" path="[[item.__firebaseKey__]]"></oyloo-item>
          </template>
        </iron-collapse>
      </div>
    </paper-card>
  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'oyloo-list',
        behaviors: [Oyloo.DocumentBehavior],
        _toggle: function() {
          this.$.button.icon = this.$.list.opened ?
            'hardware:keyboard-arrow-up' :
            'hardware:keyboard-arrow-down';
          this.$.list.toggle();
        }
      });
    })();
  </script>
</dom-module>
